# Документация: приложение «События» (events)

Документ описывает модели и разделы админ-панели, связанные с мероприятиями PM.Meetup: категории, спикеры, события, расписание, регистрации и галереи.

---

## 1. Назначение приложения

Приложение **events** отвечает за:

- **События** — митапы, воркшопы, конференции, нетворкинг (название, описание, дата, место, формат, статус).
- **Категории и теги** — тематика событий и общие теги (теги хранятся в приложении core).
- **Спикеры** — база спикеров с привязкой к событиям и сегментам программы.
- **Расписание события** — сегменты программы (доклады, кофе-брейки) с временем и спикерами.
- **Регистрации** — кто на какое событие зарегистрирован, статус подтверждения и отметка о посещении.
- **Галереи** — фотографии прошедших событий (в т.ч. ссылка на внешний альбом, например VK).

Все модели, кроме связей с пользователем, используют общую базу **TimeStampedModel** (из core): поля `created_at` и `updated_at` заполняются автоматически.

---

## 2. Модели

### 2.1. EventCategory (категория событий)

Тематика мероприятий (например: «Управление проектами», «AI», «Стартапы»).

| Поле | Тип | Описание |
|------|-----|----------|
| name | CharField(100) | Название категории |
| slug | SlugField(120), уникальный | URL-путь (подставляется из названия) |
| description | TextField | Описание (необязательно) |
| order | PositiveIntegerField | Порядок отображения в списках |
| created_at, updated_at | DateTimeField | Авто (из TimeStampedModel) |

Один **Event** может относиться к нескольким категориям (связь «многие ко многим»).

---

### 2.2. Speaker (спикер)

Профиль спикера для повторного использования в разных событиях.

| Поле | Тип | Описание |
|------|-----|----------|
| full_name | CharField(200) | ФИО |
| position | CharField(200) | Должность |
| company | CharField(200) | Компания |
| photo | ImageField | Фотография (media/speakers/) |
| bio | TextField | Биография |
| email | EmailField | Email для связи |
| social_links | JSONField | Ссылки на соцсети (словарь) |
| topics | M2M → Tag | Темы выступлений (теги из core) |
| created_at, updated_at | DateTimeField | Авто |

Спикер может быть привязан к **событию** в целом и к отдельным **сегментам** программы (EventSegment).

---

### 2.3. Event (событие)

Основная модель мероприятия.

| Поле | Тип | Описание |
|------|-----|----------|
| title | CharField(200) | Название |
| slug | SlugField(220), уникальный | URL-путь страницы события |
| description | MDTextField | Описание (Markdown) |
| date | DateField | Дата проведения |
| time_start, time_end | TimeField | Время начала и окончания |
| format | CharField, выбор | offline / online / hybrid |
| location_address | CharField(300) | Адрес (офлайн) |
| location_city | CharField(100) | Город |
| location_venue | CharField(200) | Помещение/зал |
| online_url | URLField | Ссылка на трансляцию (онлайн) |
| online_platform | CharField(100) | Платформа (Zoom и т.п.) |
| event_type | CharField, выбор | meetup / workshop / conference / networking |
| cover_image | ImageField | Обложка (media/events/) |
| capacity | PositiveIntegerField | Лимит участников (0 = без лимита) |
| price | DecimalField | Цена участия |
| registration_type | CharField, выбор | open / requires_approval / closed |
| status | CharField, выбор | draft / published / registration_closed / completed / cancelled |
| cancellation_reason | TextField | Причина отмены (если status=cancelled) |
| meta_title, meta_description | CharField | SEO |
| is_featured | BooleanField | Показывать в блоке «Ваш выбор» |
| categories | M2M → EventCategory | Категории |
| tags | M2M → Tag (core) | Теги |
| speakers | M2M → Speaker | Спикеры события |
| created_at, updated_at | DateTimeField | Авто |

**Статусы события:** черновик → опубликовано → регистрация закрыта → завершено / отменено.

---

### 2.4. EventSegment (сегмент программы)

Один элемент расписания: доклад, кофе-брейк, панель и т.п.

| Поле | Тип | Описание |
|------|-----|----------|
| event | FK → Event | Событие |
| title | CharField(200) | Название сегмента |
| description | TextField | Описание |
| time_start, time_end | TimeField | Время начала и окончания |
| order | PositiveIntegerField | Порядок вывода |
| location | CharField(200) | Место (для многозальных событий) |
| speakers | M2M → Speaker | Спикеры этого сегмента |
| created_at, updated_at | DateTimeField | Авто |

В админке сегменты можно редактировать прямо в карточке события (inline).

---

### 2.5. EventRegistration (регистрация на событие)

Связь «пользователь зарегистрировался на событие». Один пользователь — одна регистрация на одно событие (unique_together: user + event).

| Поле | Тип | Описание |
|------|-----|----------|
| user | FK → User (users) | Участник |
| event | FK → Event | Событие |
| status | CharField, выбор | pending / confirmed / cancelled |
| attendance_status | CharField, выбор | unknown / attended / no_show |
| extra_data | JSONField | Доп. поля формы регистрации |
| created_at, updated_at | DateTimeField | Авто |

---

### 2.6. EventGallery (галерея события)

Фотографии или ссылка на альбом после мероприятия.

| Поле | Тип | Описание |
|------|-----|----------|
| event | FK → Event | Событие |
| title | CharField(200) | Название галереи |
| cover_image | ImageField | Обложка (media/galleries/) |
| photo_count | PositiveIntegerField | Количество фото |
| external_album_url | URLField | Ссылка на альбом (VK и т.п.) |
| created_at, updated_at | DateTimeField | Авто |

---

## 3. Админ-панель

### 3.1. Категории событий

- Список: название, slug, порядок, дата создания. Порядок можно менять в списке (list_editable).
- Slug подставляется автоматически из названия (prepopulated_fields).
- Поиск по названию.

### 3.2. Спикеры

- Список: ФИО, должность, компания, дата создания.
- Фильтр по темам выступлений (topics). Теги выбираются в два списка (filter_horizontal).
- Поиск по ФИО и компании.

### 3.3. События

- Список: название, дата, время начала, тип, формат, статус, «Ваш выбор», лимит, дата создания. Статус и «Ваш выбор» можно менять в списке.
- Фильтры: статус, тип события, формат, «Ваш выбор».
- Иерархия по дате (date_hierarchy).
- В карточке события — вложенная таблица сегментов программы (EventSegmentInline): добавление/редактирование сегментов без перехода в отдельный раздел.
- Категории, теги и спикеры выбираются в два списка (filter_horizontal).
- Slug подставляется из названия. Поля created_at, updated_at только для чтения.

### 3.4. Сегменты программы

- Отдельный раздел для тех, кто хочет редактировать сегменты отдельно от события.
- Список: событие, название сегмента, время начала/окончания, порядок. Фильтр по событию, выбор спикеров в два списка.

### 3.5. Регистрации на события

- Список: пользователь, событие, статус, посещение, дата регистрации.
- Фильтры по статусу и посещению. Иерархия по дате. Поиск по email пользователя и названию события.
- Даты только для чтения.

### 3.6. Галереи событий

- Список: событие, название галереи, количество фото, дата. Фильтр по событию, поиск по названию.

---

## 4. Связи с другими приложениями

- **core** — теги (Tag) используются в событиях и спикерах.
- **users** — регистрация (EventRegistration) ссылается на пользователя (AUTH_USER_MODEL).
- **content** — партнёр (Partner) может быть привязан к конкретному событию (FK Event, необязательно).

---

## 5. Краткая сводка для заказчика

| Вопрос | Ответ |
|--------|--------|
| Где создавать мероприятия? | Админка → События. Можно задать дату, место, формат, лимит, цену, статус. |
| Как задать программу события? | В карточке события — блок «Сегменты программы» или раздел «Сегменты программы». |
| Где хранятся спикеры? | Раздел «Спикеры»; одного спикера можно привязать к разным событиям и сегментам. |
| Как посмотреть регистрации? | Раздел «Регистрации на события»: кто на какое событие записан, статус, посетил/не явился. |
| Где галереи после мероприятия? | Раздел «Галереи событий»: можно указать ссылку на альбом (VK и т.д.) и обложку. |
| Что такое «Ваш выбор»? | Флаг у события (is_featured) — такие события можно выводить в блоке «Ваш выбор» на сайте. |
